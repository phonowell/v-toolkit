(function(){var e,t,i,n,r,o;i=require("lodash"),e=require("fire-keeper"),r=require("path"),o=require("pug"),n=require("coffeescript"),t=function(){class t{constructor(e="default"){var t,i,n,o,a,s,c;for(t=0,o=(s=this.feature).length;t<o;t++)(e=>(this.fn[e]=require(r.resolve(__dirname,e)),this[e]=((...t)=>this.enabled[e]?this.fn[e](...t):t[0])))(n=s[t]);if("default"===e)for(i=0,a=(c=this.feature).length;i<a;i++)n=c[i],this.enabled[n]=!0}async compileCoffee_(t,r={}){var o;return o=await e.read_(t),o=i.trim(o||""),o=this.signMethod(o,t),o=this.injectLodash(o),o=this.injectFn(o),o=this.injectComponent(o,r.component),o=this.replaceThrow(o),n.compile(o)}async compilePug_(t){var n,r;return r=await e.read_(t),r=i.trim(r||""),~t.search("index.pug")&&(r=this.injectContainer(r)),r=this.injectComponentGlobal(r),r=this.signComponent(r),(n=new String(o.compile(r)())).component=r.component,n}async compileStyl_(t){var n;return n=await e.read_(t),n=i.trim(n||""),n=this.injectBasic(n),(n=new String(n)).isScoped=!n.search(/\s*\/{2}\s*@scope/),n}async compile_(t){var n,r,o,a,s,c,p,l,h;if("string"!==(h=e.type(t)))throw new Error(`compiler/error: invalid type of path: '${h}'`);return({basename:n,pathSource:p,pathTarget:l}=this.makeVariable(t)),e.info().pause(),a=await e.read_(`${p}/${n}.yaml`),r=await this.compilePug_(`${p}/${n}.pug`),c=await this.compileStyl_(`${p}/${n}.styl`),o=await this.compileCoffee_(`${p}/${n}.coffee`,{component:r.component}),s=[],i.size(a)&&(s=[...s,"<config>",e.parseString(a),"</config>"]),r.length&&(s=[...s,"<template>",r,"</template>"]),c.length&&(s=[...s,c.isScoped?'<style lang="stylus" scoped>':'<style lang="stylus">',c,"</style>"]),o.length&&(s=[...s,"<script>",o,"<\/script>"]),await e.write_(l,s.join("\n")),e.info().resume(),e.info(`made '${l}'`),this}}return t.prototype.enabled={},t.prototype.feature=["injectBasic","injectComponent","injectComponentGlobal","injectContainer","injectFn","injectLodash","makeVariable","replaceThrow","signComponent","signMethod"],t.prototype.fn={},t}.call(this),module.exports=function(...e){var i,n;return(i=(n=new t(...e)).compile_.bind(n)).coffee_=n.compileCoffee_.bind(n),i}}).call(this);